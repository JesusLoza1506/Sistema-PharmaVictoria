<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox styleClass="productos-view" stylesheets="@/css/Inventario/productos.css" xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.farmaciavictoria.proyectopharmavictoria.controller.Inventario.ProductosController">
   <children>
      <!-- Header -->
      <VBox spacing="0" styleClass="productos-header-box">
         <children>
            <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="productos-header">
               <children>
                  <HBox alignment="CENTER_LEFT" spacing="10.0">
                     <children>
                        <ImageView fitHeight="32" fitWidth="32" preserveRatio="true">
                           <image>
                              <Image url="@/icons/inventario.png" />
                           </image>
                        </ImageView>
                        <Label styleClass="productos-header-title" text="GESTI√ìN DE PRODUCTOS" />
                     </children>
                  </HBox>
                  <Region HBox.hgrow="ALWAYS" />
                           <Button fx:id="btnNuevoProducto" mnemonicParsing="false" onAction="#onNuevoProducto" styleClass="productos-header-btn-blue">
                              <graphic>
                                 <ImageView fitHeight="22" fitWidth="22" preserveRatio="true">
                                    <image>
                                       <Image url="@/icons/agregar-producto.png" />
                                    </image>
                                 </ImageView>
                              </graphic>
                              <text>Nuevo Producto</text>
                           </Button>
                           <Button fx:id="btnExportar" mnemonicParsing="false" onAction="#onExportar" styleClass="productos-header-btn-green">
                              <graphic>
                                 <ImageView fitHeight="22" fitWidth="22" preserveRatio="true">
                                    <image>
                                       <Image url="@/icons/exportar.png" />
                                    </image>
                                 </ImageView>
                              </graphic>
                              <text>Exportar</text>
                           </Button>
                           <Button fx:id="btnEdicionMasiva" mnemonicParsing="false" onAction="#onEdicionMasiva" styleClass="productos-header-btn-orange">
                              <graphic>
                                 <ImageView fitHeight="22" fitWidth="22" preserveRatio="true">
                                    <image>
                                       <Image url="@/icons/edit-producto.png" />
                                    </image>
                                 </ImageView>
                              </graphic>
                              <text>Edici√≥n Masiva</text>
                           </Button>
               </children>
               <padding>
                  <Insets bottom="18.0" left="24.0" right="24.0" top="18.0" />
               </padding>
            </HBox>
            <HBox alignment="CENTER" spacing="24.0" styleClass="filter-bar">
               <children>
                  <Label styleClass="filter-label" text="Buscar:" />
                  <TextField fx:id="txtBuscar" onKeyReleased="#onBuscar" prefWidth="180.0" promptText="C√≥digo, nombre o principio activo" styleClass="search-field" />
                  <Label styleClass="filter-label" text="Buscar por:" />
                  <ComboBox fx:id="cmbBusquedaStrategy" prefWidth="120.0" promptText="Nombre" styleClass="filter-combo" />
                  <Label styleClass="filter-label" text="Categor√≠a:" />
                  <ComboBox fx:id="cmbCategoria" onAction="#onFiltrarCategoria" prefWidth="120.0" promptText="Todas las categor√≠as" styleClass="filter-combo" />
                  <Label styleClass="filter-label" text="Estado:" />
                  <ComboBox fx:id="cmbEstado" onAction="#onFiltrarEstado" prefWidth="120.0" promptText="Todos" styleClass="filter-combo" />
                  <CheckBox fx:id="chkMostrarInactivos" onAction="#onToggleMostrarInactivos" styleClass="filter-checkbox" text="Mostrar inactivos" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Label fx:id="lblTotalProductos" styleClass="total-count" text="Total: 0 productos" minWidth="120.0" />
               </children>
               <alignment>CENTER_LEFT</alignment>
               <spacing>12.0</spacing>
               <padding>
                  <Insets bottom="10.0" left="24.0" right="24.0" top="10.0" />
               </padding>
            </HBox>
         </children>
      </VBox>

      <!-- Tabla de Productos -->
      <VBox spacing="0" styleClass="productos-table-box" VBox.vgrow="ALWAYS">
         <children>
            <TableView fx:id="tableProductos" styleClass="productos-table" VBox.vgrow="ALWAYS">
               <columns>
                  <TableColumn fx:id="colCodigo" minWidth="100.0" prefWidth="120.0" text="C√≥digo" />
                  <TableColumn fx:id="colNombre" minWidth="200.0" prefWidth="250.0" text="Nombre" />
                  <TableColumn fx:id="colPrecioVenta" minWidth="80.0" prefWidth="100.0" text="Precio S/" />
                  <TableColumn fx:id="colStockActual" minWidth="60.0" prefWidth="80.0" text="Stock" />
                  <TableColumn fx:id="colFechaVencimiento" minWidth="100.0" prefWidth="120.0" text="Vencimiento" />
                  <TableColumn fx:id="colEstado" minWidth="120.0" prefWidth="140.0" maxWidth="180.0" text="Estado" visible="true" />
                  <TableColumn fx:id="colAcciones" minWidth="120.0" prefWidth="150.0" text="Acciones" />
               </columns>
               <columnResizePolicy>
                  <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
               </columnResizePolicy>
               <contextMenu>
                  <ContextMenu>
                    <items>
                      <MenuItem mnemonicParsing="false" onAction="#onVerDetalles" text="Ver Detalles" />
                      <MenuItem mnemonicParsing="false" onAction="#onEditarProducto" text="Editar" />
                      <SeparatorMenuItem />
                      <MenuItem mnemonicParsing="false" onAction="#onAjustarStock" text="Ajustar Stock" />
                      <MenuItem mnemonicParsing="false" onAction="#onCambiarUbicacion" text="Cambiar Ubicaci√≥n" />
                      <SeparatorMenuItem />
                      <MenuItem mnemonicParsing="false" onAction="#onEliminarProducto" text="Eliminar" />
                    </items>
                  </ContextMenu>
               </contextMenu>
            </TableView>
            <!-- Separador visual correctamente ubicado -->
            <Region minHeight="18.0" maxHeight="24.0" VBox.vgrow="NEVER" />
            <!-- Controles de paginaci√≥n -->
            <HBox alignment="CENTER" spacing="10.0" styleClass="pagination-bar">
               <children>
                  <Button fx:id="btnPaginaAnterior" text="‚ü® Anterior" onAction="#onPaginaAnterior" />
                  <Label fx:id="lblPaginaActual" text="P√°gina 1 de 1" />
                  <Button fx:id="btnPaginaSiguiente" text="Siguiente ‚ü©" onAction="#onPaginaSiguiente" />
                  <Label text="Mostrar:" styleClass="pagination-label" />
                  <ComboBox fx:id="cmbTamanoPagina" prefWidth="80.0" styleClass="pagination-combo" />
                  <Label text="por p√°gina" styleClass="pagination-label" />
               </children>
               <padding>
                  <Insets bottom="10.0" top="10.0" />
               </padding>
            </HBox>
         </children>
      </VBox>
      <!-- Leyenda y Estad√≠sticas mejoradas -->
      <HBox alignment="CENTER" spacing="60.0" styleClass="legend-stats-bar">
         <children>
            <!-- Leyenda de colores, m√°s visible -->
            <VBox alignment="TOP_LEFT" spacing="16.0" styleClass="legend-bar">
               <children>
                  <Label styleClass="legend-title" text="üé® Leyenda de Colores" />
                  <HBox alignment="CENTER_LEFT" spacing="12.0">
                     <children>
                        <Region prefHeight="18.0" prefWidth="24.0" styleClass="legend-vencido" />
                        <Label styleClass="legend-text" text="Vencidos" minWidth="80.0" maxWidth="120.0" />
                        <Region prefHeight="18.0" prefWidth="24.0" styleClass="legend-vencer" />
                        <Label styleClass="legend-text" text="Pr√≥ximos a Vencer" minWidth="130.0" maxWidth="160.0" />
                        <Region prefHeight="18.0" prefWidth="24.0" styleClass="legend-bajo" />
                        <Label styleClass="legend-text" text="Stock Bajo" minWidth="80.0" maxWidth="120.0" />
                        <Region prefHeight="18.0" prefWidth="24.0" styleClass="legend-sin-stock" />
                        <Label styleClass="legend-text" text="Sin Stock" minWidth="80.0" maxWidth="120.0" />
                     </children>
                  </HBox>
               </children>
               <padding>
                  <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
               </padding>
            </VBox>
            <!-- Estad√≠sticas, m√°s separadas y con t√≠tulos -->
            <VBox alignment="TOP_RIGHT" spacing="18.0" styleClass="stats-footer">
               <children>
                  <Label styleClass="stats-title" text="Estad√≠sticas de Inventario" />
                  <HBox alignment="CENTER" spacing="24.0">
                     <children>
                        <VBox alignment="CENTER" spacing="5.0" styleClass="stat-card">
                           <children>
                              <Label fx:id="lblTotalActivos" styleClass="stat-number" text="0" />
                              <Label styleClass="stat-label" text="Productos Activos" />
                           </children>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0" styleClass="stat-card">
                           <children>
                              <Label fx:id="lblStockBajo" styleClass="stat-number" text="0" />
                              <Label styleClass="stat-label" text="Stock Bajo" />
                           </children>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0" styleClass="stat-card">
                           <children>
                              <Label fx:id="lblProximosVencer" styleClass="stat-number" text="0" />
                              <Label styleClass="stat-label" text="Pr√≥ximos a Vencer" />
                           </children>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0" styleClass="stat-card" minWidth="180.0" maxWidth="260.0">
                           <children>
                              <Label fx:id="lblValorInventario" styleClass="stat-number2" wrapText="true" alignment="CENTER" />
                              <Label styleClass="stat-label" text="Valor Inventario" />
                           </children>
                        </VBox>
                     </children>
                  </HBox>
               </children>
               <padding>
                  <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
               </padding>
            </VBox>
         </children>
      </HBox>
   </children>
</VBox>